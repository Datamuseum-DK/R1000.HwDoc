#!/usr/local/bin/python3.8
#
# NB: We strive to use y-x coordinate order to match numpy's convention

''' STEP 210: Locate And-ish, Or-ish and Inverter-ish elements '''

import sys

import numpy as np

import schematics as sch

import templates

from corner import Corner

from debug_snippets import DebugSnippets

PATT_50 = '''
----------------------##-----------------------##-----------------------
----------------------##-----------------------##-----------------------
-----------###---#----##-----------------####--##-----------------------
----------#####-##----##-----------------####--##-----------------------
-----------####-##----##------------------###--##-----------------------
----------####--##---###-------------------##--##-----------------------
----------#####-###-##-##----------------####--##-----------------------
----------#####-###-#--##-----------------##---##-----------------------
--------------------#####----------------------##-----------------------
------------###############################################-------------
------------###############################################-------------
------------##-------------------------------------------##-------------
------------##--###-####---##------------####-####-####--##-------------
------------##-########---###------------####-###---###--##-------------
------------##-##-#####---#-##-----------##-#-##----###--##-------------
------------##-##-#####---####-----------####-##----###--##-------------
------------##-#########--####-----------####-####-####--##-------------
-###--###---##--###--###--#---------------##---###-###---##---##--------
-#########--##-------------------------------------------##---##--------
-####--###--##-------------------------------------------##---##--------
####---###--##-------------------------------------------##---##--------
####--####--#--------------------------------------------##---##--------
-###--###---##--###--###---#--------------##----#---##---##---##--------
------------##--###--####-###------------####-####--###--##-------------
-###--##-#-######----####-####-----------##---####--###-################
#################----#########-----------##---####--####################
------------##-##-##-#########-----------####-####--###--##-------------
-###---##---##--###--###--#-##------------##--#--#--###--##---##--------
-####-####--#--------------------------------------------##--####-------
-###--####--#--------------------------------------------##---###-------
-###--##----#--------------------------------------------##--###--------
-##--##-----#--------------------------------------------##--##---------
-###--####--#----##--###---#--------------##----#--###---##---###-------
------------#--####--####-###------------####--###-####--##-------------
##-----##--##---###--###--####-----------####-####--###--###-###########
#############---####-####-####------------###-####--###--###############
------------##--####-###-#####-----------####-####--###--##-------------
------------#---###--###--#-##------------###-#--#-####--##-------------
------------#--------------------------------------------##-------------
------------#--------------------------------------------##-------------
------------#--------------------------------------------##-------------
------------#--------------------------------------------##-------------
------------#----#-----#---##-------###--####--###---#---##-------------
------------#---###-##-##--##-------####-####-####--##---##-------------
------------#---###-#####--##--####-####-##---####-####--##-------------
------------#----##-#####--##--####-###--###--####--##---##-------------
------------#----#--##-##--##--####-####-##---####---#---##-------------
-------##---#----#-----#--###-------#--#-####--###---#---##---##---##---
-------##---#--------------------------------------------##--####-####--
-----####---#--------------------------------------------##---###-####--
-----####--###-------------------------------------------##--####-####--
------###---##-------------------------------------------##--####-####--
--------#---##---#----##-----------------------##----#---##--####--##---
------------##--###-#####---------------------####-####--##-------------
##########-###-##########----------------------###-####--########-####-#
##############-##########---------------------####-####--###############
------------##-##########---------------------####-####---#-------------
------###---##--#--#-###----------------------####--###--##----#---###--
-----####---##-------------------------------------------##---##--####--
-----####---#--------------------------------------------##---##--####--
--------##--#--------------------------------------------##---##---###--
-----#####--#--------------------------------------------##---##----##--
------###---#----#----#-----------------------####---#---##---##---##---
------------#---###--###----------------------####--##---##-------------
#############---#-##--##----------------------####--##----##############
#############--#####--##----------------------####--##----#############-
------------##--#-##--##----------------------####--###---#-------------
-------##---#---------##----------------------###---##----#---##--####--
------##----#--------------------------------------------##---##--####--
-----####---#--------------------------------------------##---##--####--
-----#####--##-------------------------------------------##---##--####--
-----#####--#--------------------------------------------##---##--####--
------###---##---#---###----------------------####---##--##---##---##---
------------#---###--####---------------------####-####--##-------------
##########-##--#####-####----------------------###--###--###-###########
##############-#####-###-----------------------###-###---#####-#########
------------#--#########----------------------####-####--##-------------
------####--#---#----###----------------------####-####--##----#--####--
------####--##-------------------------------------------##---##----##--
-------##---##-------------------------------------------##---##----#---
------##----##-------------------------------------------##---##---##---
------#-----##-------------------------------------------##---##--##----
------#-----##---#----##----------------------###---###--##---##--#-----
------------##--###--####---------------------####-#####-##-------------
###-#####---##--#-##--###----------------------###---##--###############
##############-#####--###----------------------###---##--###############
------------##-##########---------------------####-####--##-------------
------###---##--#--#-###----------------------####--##---##----#----#---
-----#####--##-------------------------------------------##---##---##---
-----#####--##-------------------------------------------##---##--####--
-----#####--##--------------------------------------------#---##--####--
-----#####--##-------------------------------------------##---##--####--
------###---##---#-----#----------------------####---##---#---##---##---
------------##--###---##----------------------####---##---#-------------
##############--#-##-###-----------------------###--###---######-#####-#
##############--####-####----------------------###-####---##############
------------##--#-##--###---------------------####---##---#-------------
------###---##--#--#---#----------------------###----##---#----#---###--
------####--##--------------------------------------------#---##--####--
------####--##--------------------------------------------#---##--####--
-------###--##--------------------------------------------#----#-----#--
-------###--##--------------------------------------------#---##--####--
------##----##---##--####---------------------####--###---#---##---###--
------------##--###--####---------------------####-####---#-------------
#########---##--####-####----------------------###-####---##--###-######
##############--####---##----------------------###----##--##############
------------##--####-####----------------------###-#####--#-------------
--##--###---##--#----###----------------------####--###---#----#--------
--##--####--##--------------------------------------------#---##---###--
--##--####--##--------------------------------------------#---##--####--
--##--####--##-------------------------------------------##----#--####--
--##--####--##--------------------------------------------#---##----##--
--##--###---##---#----##----------------------####---##---#---##--------
------------##--###--###----------------------####--###---#-------------
#-#---------##--####-###-----------------------#######----###-#-#-#####-
##############-#####-####----------------------###-####---##############
------------##-#####-####----------------------###-#####--#-------------
------------##--#--#-###--------##---###--###--###--###---#----#---###--
--##--###---##-----------------####-#########-------------#---##--####--
--##---##---##-----------------#####-#########------------#---##-----##-
--##---##---##-----------------#########--####------------#---##----###-
--##---##---##-----------------####-###----##-------------#---##--#####-
--##---##---##-------###-------#--#-####--##---###--###---#---###--###--
------------##--###--####----------------------###--####--#-------------
####-----#-###---###---#-----------------------###---##---##--##########
##############--####-###-----------------------###--##----##############
------------##--#######------------------------###-##-----#-------------
------------##--#--#-#-------------------------###--#-----#-------------
------------##--------------------------------------------#-------------
------------##--------------------------------------------#-------------
------------##--------------------------------------------#-------------
------------##--------------------------------------------#-------------
------------##------------####--###-####--###-------------#-------------
------------##------------####--##--####-#####------------#-------------
------------##------------###--####-####-#####------------##------------
------------##------------##---####----######-------------#-------------
------------##------------##---####-####-####-------------#-------------
------------##------------#-----###--###-####-------------#-------------
------------##--------------------------------------------#-------------
------------###############################################-------------
-------------####-####-################################-###-------------
------------------------------------------------------------------------
'''

class Sheet_251(templates.Template_Rectangle_Sheet):

    CORNERS = (
        ( "tl", -317, -119, 40),
        ( "tr", -318,  119, 40),
        ( "bl",  378, -113, 40),
        ( "br",  380,  124, 40),
    )

    SYMBOL = "F562"

if __name__ == "__main__":
    if (sys.argv[1], sys.argv[2]) not in (
        ("MEM32", "0002"),
        ("MEM32", "0003"),
        ("MEM32", "0004"),
        ("MEM32", "0005"),
        ("RESHA", "0003"),
        ("RESHA", "0007"),
        ("RESHA", "0008"),
    ):
        exit(0)
    sheet = Sheet_251(
        "F652",
        sys.argv,
        templates.string_2_template(PATT_50, reflect=False),
        templates.string_2_template(PATT_50, reflect=False),
        0.500,
        0.200,
    )
    sheet.load_raw_image()
    sheet.load_proj50_image()
    sheet.match() 
    sheet.write_image("proj50", sheet.proj50)
    sheet.write_components()
    sheet.write_interpolators()
    sheet.write_interpolated()
    sheet.write_landmarks()
